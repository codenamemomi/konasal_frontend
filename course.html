<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">

    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <title>KONASAL TRAINING INSTITUTE - Career Courses & Training</title>

    <!-- Google Fonts -->

    <link
        href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&family=Open+Sans:wght@400;600;700&display=swap"
        rel="stylesheet">

    <!-- Bootstrap & FontAwesome -->

    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">


    <!-- CSS -->
    <link rel="stylesheet" href="./assets/css/shared.css">
    <link rel="stylesheet" href="./assets/css/course.css">

    <!-- JS -->
    <script src="./assets/js/navbar.js" defer></script>
    <script src="./assets/js/footer.js" defer></script>

    <style>
        .paypal-container {
            position: relative;
        }

        .paypal-button-container {
            position: absolute;
            top: 3px;
            opacity: 0;
        }
    </style>
</head>

<body>
    <div id="navbar"></div>
    <header class="header">
        <nav class="breadcrumb"><a href="course-listing.html" style="color: white;">Courses</a>&nbsp; > &nbsp;<span
                id="nav-title"></span></nav>
        <div class="hero">
            <h1 id="title"></h1>
            <p id="summary">Lorem Ipsum is simply dummy text of the printing and typesetting industry. Lorem Ipsum has
                been the
                industry's standard dummy text ever since the 1500s, when an unknown printer took a galley of type and
                scrambled it to make a type specimen book. It has survived not only five centuries,</p>
            <p>Duration: <span id="duration"></span></p>
            <div class="pricing">
                <span class="price" id="price"></span>
                <div class="paypal-container">
                    <button class="enroll-button">Enroll Now</button>
                    <div id="paypal-button-container" class="paypal-button-container"></div>
                </div>
            </div>
        </div>
        <div id="headerImg"></div>
    </header>
    <div class="coupon-box">
        <input type="text" id="coupon-code" placeholder="Enter coupon code" class="form-control" />
        <button id="apply-coupon" class="btn-outline-primary btn btn-sm">Apply Coupon</button>
        <p id="coupon-message" style="font-size: 0.9em;margin: 0;"></p>
    </div>

    <main class="content">
        <div class="course-tabs">
            <p data-target="about">Description</p>
            <p data-target="objective">Objectives</p>
            <p data-target="curriculum">Curriculum</p>
            <p data-target="targetA">Target Audience</p>
            <p data-target="coursebenefits">Benefits</p>
            <p data-target="courseCompletions">Course Completion</p>
        </div>
        <section id="about">
            <h4>Description</h4>
            <p id="description">Lorem Ipsum is simply dummy text of the printing and typesetting industry. Lorem Ipsum
                has been the
                industry's standard dummy text ever since the 1500s, when an unknown printer took a galley of type and
                scrambled it to make a type specimen book. It has survived not only five centuries,Lorem Ipsum is simply
                dummy text of the printing and typesetting industry. Lorem Ipsum has been the industry's standard dummy
                text ever since the 1500s, when an unknown printer took a galley of type and scrambled it to make a type
                specimen book. It has survived not only five centuries,Lorem Ipsum is simply dummy text of the printing
                and typesetting industry. Lorem Ipsum has been the industry's standard dummy text ever since the 1500s,
                when an unknown printer took a galley of type and scrambled it to make a type specimen book. It has
                survived not only five centuries.</p>
        </section>

        <section class="objectives" id="objective">
            <h4>Course Objectives</h4>
            <ul id="objectives"></ul>
        </section>

        <section id="curriculum">
            <h4>Course curriculum</h4>
        </section>

        <section id="targetA">
            <h4>Target Audience</h4>
            <ul id="target"></ul>
        </section>

        <section id="coursebenefits">
            <h4>Course Benefits</h4>
            <ul id="coursebenefit"></ul>
        </section>

        <section id="courseCompletions">
            <h4>Course Completion</h4>
            <p id="courseCompletion"></p>
        </section>
    </main>

    <div id="footer"></div>


    <script>
        const tabs = document.querySelectorAll(".course-tabs p");
        const sections = document.querySelectorAll("section");

        tabs.forEach(tab => {
            tab.addEventListener("click", () => {
                const targetId = tab.getAttribute("data-target");
                const section = document.getElementById(targetId);
                if (section) {
                    const offset = 100;
                    const top = section.getBoundingClientRect().top + window.pageYOffset - offset;

                    window.scrollTo({
                        top,
                        behavior: "smooth"
                    });
                }
            });
        });


    </script>
    <script
        src="https://www.paypal.com/sdk/js?client-id=AZBBqmukW9x9cQ2HPU9tBWUMI4zQ0URlLgM-QCzUgp6rOfRyW8f_gfXdQQjM_koi6cmnTlJPXvgHSF6v&currency=USD"></script>

    <script type="module" defer>
        const params = new URLSearchParams(window.location.search);
        const courseId = params.get('id');


        if (!courseId || courseId.trim() === "") {
            window.location.href = "course-listing.html";
        }


        const course = courses.find(c => c.name === courseId);


        if (!course) {
            window.location.href = "course-listing.html";
        }


        // Course data
        import courses from './assets/js/courses.js';
        document.addEventListener('DOMContentLoaded', function () {


            document.getElementById("nav-title").innerHTML = course.name;
            document.getElementById("title").innerHTML = course.name;
            document.getElementById("price").innerHTML = "$" + course.price;
            document.getElementById("summary").innerHTML = course.summary;
            document.getElementById("duration").innerHTML = course.duration;
            document.getElementById("description").innerHTML = course.description;
            document.getElementById("headerImg").innerHTML = `<img src="${course.image}" />`;
            const obj = document.getElementById("objectives");

            course.courseObjectives.forEach(item => {
                const li = document.createElement("li");

                const parts = item.split(":");
                const boldPart = parts[0] + ":";
                const rest = parts.slice(1).join(":").trim();

                li.innerHTML = `<strong>${boldPart}</strong> ${rest}`;
                obj.appendChild(li);
            });



            const container = document.getElementById("curriculum");

            course.curriculum.forEach(module => {

                const moduleDiv = document.createElement("div");
                moduleDiv.classList.add("module");


                const button = document.createElement("button");
                button.classList.add("accordion");
                button.textContent = module.day;


                const panel = document.createElement("div");
                panel.classList.add("panel");


                const ul = document.createElement("ul");
                module.topics.forEach(topic => {
                    const li = document.createElement("li");
                    li.textContent = topic;
                    ul.appendChild(li);
                });
                panel.appendChild(ul);


                moduleDiv.appendChild(button);
                moduleDiv.appendChild(panel);
                container.appendChild(moduleDiv);


                button.addEventListener("click", () => {
                    panel.style.display = panel.style.display === "block" ? "none" : "block";
                });

            });

            const target = document.getElementById("target");

            course.targetAudience.forEach(item => {
                const li = document.createElement("li");

                const parts = item.split(":");
                const boldPart = parts[0] + ":";
                const rest = parts.slice(1).join(":").trim();

                li.innerHTML = `<strong>${boldPart}</strong> ${rest}`;
                target.appendChild(li);
            });

            const coursebenefit = document.getElementById("coursebenefit");

            course.courseBenefits.forEach(item => {
                const li = document.createElement("li");

                const parts = item.split(":");
                const boldPart = parts[0] + ":";
                const rest = parts.slice(1).join(":").trim();

                li.innerHTML = `<strong>${boldPart}</strong> ${rest}`;
                coursebenefit.appendChild(li);
            });

            const courseCompletion = document.getElementById("courseCompletion").innerHTML = course.courseCompletion;



            let originalPrice = parseFloat(course.price.replace(/,/g, ''));
            let finalPrice = originalPrice;

            const couponInput = document.getElementById('coupon-code');
            const applyButton = document.getElementById('apply-coupon');
            const couponMessage = document.getElementById('coupon-message');
            const priceDisplay = document.getElementById('price');

            // Create a remove button dynamically
            const removeButton = document.createElement('button');
            removeButton.textContent = "Remove Coupon";
            removeButton.className = "btn btn-sm btn-danger";
            removeButton.style.display = "none"; // initially hidden

            // Insert remove button after the apply button
            applyButton.parentNode.appendChild(removeButton);

            // Handle applying the coupon
            applyButton.addEventListener('click', () => {
                const code = couponInput.value.trim().toLowerCase();

                if (code === "konasal30") {
                    finalPrice = originalPrice * 0.7; // 30% off
                    priceDisplay.innerHTML = "$" + finalPrice.toLocaleString();
                    couponMessage.innerText = "Coupon applied! 30% off.";
                    couponMessage.style.color = "green";
                    couponInput.disabled = true;
                    applyButton.disabled = true;
                    removeButton.style.display = "inline-block";
                } else {
                    finalPrice = originalPrice; // reset
                    priceDisplay.innerHTML = "$" + finalPrice.toLocaleString();
                    couponMessage.innerText = "Invalid coupon.";
                    couponMessage.style.color = "red";
                }
            });

            // Handle removing the coupon
            removeButton.addEventListener('click', () => {
                finalPrice = originalPrice;
                priceDisplay.innerHTML = "$" + finalPrice.toLocaleString();
                couponInput.disabled = false;
                applyButton.disabled = false;
                couponInput.value = '';
                couponMessage.innerText = '';
                removeButton.style.display = "none";
            });


            paypal.Buttons({
                style: {
                    layout: 'vertical',
                    color: 'blue',
                    shape: 'rect',
                    label: 'paypal'
                },
                createOrder: function (data, actions) {
                    return actions.order.create({
                        purchase_units: [{
                            description: `Enrollment for ${course.name}`,
                            amount: {
                                value: finalPrice // Replace with your course price
                            }
                        }]
                    });
                },
                onApprove: function (data, actions) {
                    return actions.order.capture().then(function (details) {
                        alert('Payment Successful! Thank you, ' + details.payer.name.given_name + '!');
                        // You can also redirect to a success page here
                    });
                },
                onError: function (err) {
                    console.error(err);
                    alert('Payment could not be completed. Please try again.');
                }
            }).render('#paypal-button-container');

        });
    </script>


</body>

</html>